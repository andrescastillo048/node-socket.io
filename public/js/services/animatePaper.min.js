!function(exports,global){"use strict";function Animation(e,t,n,a){var i=this;i.stopped=!1,i.startTime=(new Date).getTime(),i.settings=_initializeSettings(n),i.item=e,i.tweens=[],i.ticker=null,i._continue=a,"undefined"==typeof e.data._animatePaperAnims&&(i.item.data._animatePaperAnims=[]),i._dataIndex=i.item.data._animatePaperAnims.length,i.item.data._animatePaperAnims[i._dataIndex]=i;for(var o in t)t.hasOwnProperty(o)&&i.tweens.push(new Tween(o,t[o],i));"onFrame"===i.settings.mode&&(i.ticker=animatePaper.frameManager.add(i.item,"_animate"+i.startTime,function(){i.tick()}))}function _initializeSettings(e){var t={duration:400,easing:"linear",complete:void 0,step:void 0,mode:"onFrame"};return"undefined"==typeof e&&(e={}),"undefined"==typeof e.duration?e.duration=t.duration:(e.duration=Number(e.duration),e.duration<1&&(e.duration=t.duration)),"undefined"==typeof e.easing&&(e.easing=t.easing),"undefined"!=typeof easing[e.easing]&&easing.hasOwnProperty(e.easing)?e.easingFunction=easing[e.easing]:(e.easing=t.easing,e.easingFunction=easing[t.easing]),"function"!=typeof e.complete&&(e.complete=void 0),"function"!=typeof e.step&&(e.step=void 0),-1===["onFrame","timeout"].indexOf(e.mode)&&(e.mode=t.mode),e}function Tween(e,t,n){var a=this;a.A=n,a.item=n.item,a.prop=e,a.end=t,a.start=a.cur(),a.now=a.cur(),a.direction=a.end>a.start?"+":"-"}function frameManagerHandler(e){var t=this;if("undefined"!=typeof t.data._customHandlers&&t.data._customHandlersCount>0)for(var n in t.data._customHandlers)t.data._customHandlers.hasOwnProperty(n)&&"function"==typeof t.data._customHandlers[n]&&t.data._customHandlers[n].call(t,e)}function _pointDiff(a,b,operator){if(-1!==["+","-"].indexOf(operator)&&"undefined"!=typeof a&&"undefined"!=typeof b){var ax,bx,ay,by;ax=a.x||0,bx=b.x||0,ay=a.y||0,by=b.y||0;var output=new paper.Point(eval(ax+operator+bx),eval(ay+operator+by));return output}}global.animatePaper=exports;var paper=global.paper,dirRegexp=/^([+\-])(.+)/;Animation.prototype.tick=function(){var e=this;if(e.stopped)return!1;for(var t=(new Date).getTime(),n=Math.max(0,e.startTime+e.settings.duration-t),a=n/e.settings.duration||0,i=1-a,o=0,r=e.tweens.length;r>o;o++)e.tweens[o].run(i);return"undefined"!=typeof e.settings.step&&e.settings.step.call(e.item,{percent:i,remaining:n}),e.item.project.view.draw(),"timeout"===e.settings.mode,1>i&&r?n:(e.end(),!1)},Animation.prototype.stop=function(e){var t=this,n=0,a=e?t.tweens.length:0;if(t.stopped)return t;for(t.stopped=!0;a>n;n++)t.tweens[n].run(1);e&&(t._continue&&(t._continue=null),t.end())},Animation.prototype.end=function(){var e=this;"onFrame"===e.settings.mode&&animatePaper.frameManager.remove(e.item,e.ticker),"undefined"!=typeof e.settings.complete&&e.settings.complete.call(e.item),"timeout"===e.settings.mode,"function"==typeof e._continue&&e._continue.call(e.item),e.item.data._animatePaperAnims[e._dataIndex]=null,e=null},Tween.prototype.cur=function(){var e=this,t=_tweenPropHooks[e.prop];return t&&t.get?t.get(e):_tweenPropHooks._default.get(e)},Tween.prototype.run=function(e){var t,n=this,a=_tweenPropHooks[n.prop],i=n.A.settings;return n.pos=t=i.duration?easing[i.easing](e,i.duration*e,0,1,n.duration):e,a&&a.ease?a.ease(n,t):n.now=(n.end-n.start)*t+n.start,a&&a.set?a.set(n):_tweenPropHooks._default.set(n),n},animatePaper.frameManager={add:function(e,t,n){return"undefined"==typeof e.data._customHandlers&&(e.data._customHandlers={},e.data._customHandlersCount=0),e.data._customHandlers[t]=n,e.data._customHandlersCount+=1,e.data._customHandlersCount>0&&(e.onFrame=frameManagerHandler),t},remove:function(e,t){"undefined"!=typeof e.data._customHandlers&&(e.data._customHandlers[t]=null,e.data._customHandlersCount-=1,e.data._customHandlersCount<=0&&(e.data._customHandlersCount=0))}};for(var _tweenPropHooks={_default:{get:function(e){var t;return null!=e.item[e.prop]&&(t=e.item[e.prop]),t},set:function(e){var t={};t[e.prop]=e.now,e.item.set(t)}},scale:{get:function(e){e.item.data._animatePaperVals||(e.item.data._animatePaperVals={}),"undefined"==typeof e.item.data._animatePaperVals.scale&&(e.item.data._animatePaperVals.scale=1);var t=e.item.data._animatePaperVals.scale;return t},set:function(e){var t=e.item.data._animatePaperVals.scale,n=e.now/t;e.item.data._animatePaperVals.scale=e.now,e.item.scale(n)}},rotate:{get:function(e){e.item.data._animatePaperVals||(e.item.data._animatePaperVals={}),"undefined"==typeof e.item.data._animatePaperVals.rotate&&(e.item.data._animatePaperVals.rotate=-0);var t=e.item.data._animatePaperVals.rotate;return t},set:function(e){var t=e.item.data._animatePaperVals.rotate,n=e.now-t;e.item.data._animatePaperVals.rotate=e.now,e.item.rotate(n)}},translate:{get:function(e){e.item.data._animatePaperVals||(e.item.data._animatePaperVals={}),"undefined"==typeof e.item.data._animatePaperVals.translate&&(e.item.data._animatePaperVals.translate=new paper.Point(0,0));var t=e.item.data._animatePaperVals.translate;return t},set:function(e){var t=e.item.data._animatePaperVals.translate,n=_pointDiff(e.now,t,"-");e.item.data._animatePaperVals.translate=e.now,e.item.translate(n)},ease:function(e,t){var n=_pointDiff(e.end,e.start,"-");return n.x=n.x*t,n.y=n.y*t,e.now=_pointDiff(n,e.start,"+"),e.now}},segmentGrow:{get:function(e){if(!(e.item instanceof paper.Path))throw new Error("Only a Path object can be used with : segmentGrow");var t=e.item.lastSegment.point;return t},set:function(e){e.item.add(e.now)},ease:function(e,t){var n=_pointDiff(e.end,e.start,"-");return n.x=n.x*t,n.y=n.y*t,e.now=_pointDiff(n,e.start,"+"),e.now}},position:{get:function(e){return{x:e.item.position.x,y:e.item.position.y}},set:function(e){e.item.position.x+=e.now.x,e.item.position.y+=e.now.y},ease:function(e,t){var n="",a="",i=null,o=null;"undefined"==typeof e._easePositionCache&&(e._easePositionCache={x:0,y:0});var r=Number(e.end.x||0),s=Number(e.end.y||0);if(e.end.x)var i=(""+e.end.x).match(dirRegexp);if(e.end.y)var o=(""+e.end.y).match(dirRegexp);i&&(n=i[1],r=Number(i[2])),o&&(a=o[1],s=Number(o[2]));var p=function(e){return(e||0)*t};return"undefined"!=typeof e.end.x?"+"===n?(e.now.x=p(r)-e._easePositionCache.x,e._easePositionCache.x+=e.now.x):"-"===n?(e.now.x=p(r)-e._easePositionCache.x,e._easePositionCache.x+=e.now.x,e.now.x=-e.now.x):(e.now.x=(s-e.start.x)*t-e._easePositionCache.x,e._easePositionCache.x+=e.now.x):e.now.x=0,"undefined"!=typeof e.end.y?"+"===a?(e.now.y=p(s)-e._easePositionCache.y,e._easePositionCache.y+=e.now.y):"-"===a?(e.now.y=p(s)-e._easePositionCache.y,e._easePositionCache.y+=e.now.y,e.now.y=-e.now.y):(e.now.y=(s-e.start.y)*t-e._easePositionCache.y,e._easePositionCache.y+=e.now.y):e.now.y=0,e.now}},Color:{get:function(e){return{hue:e.item[e.prop].hue,brightness:e.item[e.prop].brightness,saturation:e.item[e.prop].saturation}},set:function(e){e.item[e.prop].hue+=e.now.hue,e.item[e.prop].brightness+=e.now.brightness,e.item[e.prop].saturation+=e.now.saturation},ease:function(e,t){for(var n=["hue","brightness","saturation"],a=function(e){return(e||0)*t},i=0,o=n.length;o>i;i++){var r=n[i],s="",p="";"undefined"==typeof e._easeColorCache&&(e._easeColorCache={}),"undefined"==typeof e._easeColorCache[r]&&(e._easeColorCache[r]=0);var u=Number(e.end[r]||0);if(e.end[r])var p=(""+e.end[r]).match(dirRegexp);p&&(s=p[1],u=Number(p[2])),"undefined"!=typeof e.end[r]?"+"===s?(e.now[r]=a(u)-e._easeColorCache[r],e._easeColorCache[r]+=e.now[r]):"-"===s?(e.now[r]=a(u)-e._easeColorCache[r],e._easeColorCache[r]+=e.now[r],e.now[r]=-e.now[r]):(e.now[r]=(u-e.start[r])*t-e._easeColorCache[r],e._easeColorCache[r]+=e.now[r]):e.now[r]=0}return e.now}}},_colorProperties=["fill","stroke"],i=0,l=_colorProperties.length;l>i;i++)_tweenPropHooks[_colorProperties[i]+"Color"]=_tweenPropHooks.Color;for(var easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},__tempEasing=["Quad","Cubic","Quart","Quint","Expo"],i=0,l=__tempEasing.length;l>i;i++)easing[__tempEasing[i]]=function(e){return Math.pow(e,i+2)};__tempEasing=null;for(var name in easing)if(easing.hasOwnProperty(name)){var easeIn=easing[name];easing["easeIn"+name]=easeIn,easing["easeOut"+name]=function(e){return 1-easeIn(1-e)},easing["easeInOut"+name]=function(e){return.5>e?easeIn(2*e)/2:1-easeIn(-2*e+2)/2}}animatePaper.fx={grow:function(e,t){return animatePaper.animate(e,{properties:{segmentGrow:t.to},settings:{easing:t.easing,complete:t.complete}}),e},shake:function(e,t){for(var n=2*Math.floor(t?t.nb||2:2),a=Math.floor(t?t.movement||40:40),i=[],o=!0;n>0;n--){var r=n%2?"+":"-",s=a,p=null;1===n&&t&&"undefined"!=typeof t.complete&&(p=t.complete),(o||1===n)&&(s/=2,o=!1),i.push({properties:{position:{x:r+s}},settings:{duration:100,easing:"swing",complete:p}})}animatePaper.animate(e,i)},fadeIn:function(e,t){var n=500,a=void 0,i="swing";"undefined"!=typeof t&&("undefined"!=typeof t.duration&&(n=Number(t.duration)),"function"==typeof t.complete&&(a=t.complete),"undefined"!=typeof t.easing&&(i=t.easing)),animatePaper.animate(e,{properties:{opacity:1},settings:{duration:n,easing:i,complete:a}})},fadeOut:function(e,t){var n=500,a=void 0,i="swing";"undefined"!=typeof t&&("undefined"!=typeof t.duration&&(n=Number(t.duration)),"function"==typeof t.complete&&(a=t.complete),"undefined"!=typeof t.easing&&(i=t.easing)),animatePaper.animate(e,{properties:{opacity:0},settings:{duration:n,easing:i,complete:a}})},slideUp:function(e,t){var n=500,a=void 0,i=50,o="swing";"undefined"!=typeof t&&("undefined"!=typeof t.duration&&(n=Number(t.duration)),"function"==typeof t.complete&&(a=t.complete),"undefined"!=typeof t.easing&&(o=t.easing),"undefined"!=typeof t.distance&&(i=t.distance)),animatePaper.animate(e,{properties:{opacity:1,position:{y:"-"+i}},settings:{duration:n,easing:o,complete:a}})},slideDown:function(e,t){var n=500,a=void 0,i=50,o="swing";"undefined"!=typeof t&&("undefined"!=typeof t.duration&&(n=Number(t.duration)),"function"==typeof t.complete&&(a=t.complete),"undefined"!=typeof t.easing&&(o=t.easing),"undefined"!=typeof t.distance&&(i=t.distance)),animatePaper.animate(e,{properties:{opacity:0,position:{y:"+"+i}},settings:{duration:n,easing:o,complete:a}})},splash:function(e,t){var n=500,a=void 0,i="swing";"undefined"!=typeof t&&("undefined"!=typeof t.duration&&(n=Number(t.duration)),"function"==typeof t.complete&&(a=t.complete),"undefined"!=typeof t.easing&&(i=t.easing)),animatePaper.animate(e,{properties:{opacity:1,scale:3,rotate:360},settings:{duration:n,easing:i,complete:a}})}},exports.animate=function(e,t){var n=[];t instanceof Array?n=t:n.push(t);var a=0;return new Animation(e,n[a].properties,n[a].settings,function i(){a++,"undefined"!=typeof n[a]&&new Animation(e,n[a].properties,n[a].settings,i)}),e},exports.stop=function(e,t){if(e.data._animatePaperAnims)for(var n=0,a=e.data._animatePaperAnims.length;a>n;n++)e.data._animatePaperAnims[n]&&e.data._animatePaperAnims[n].stop(t);return e},exports.extendEasing=function(e){for(var t in e)e.hasOwnProperty(t)&&(easing[t]=e[t])},exports.extendPropHooks=function(e){for(var t in e)e.hasOwnProperty(t)&&(_tweenPropHooks[t]=e[t])},paper.Item.prototype.animate||(paper.Item.prototype.animate=function(e){return animatePaper.animate(this,e)}),paper.Item.prototype.stop||(paper.Item.prototype.stop=function(e){return animatePaper.stop(this,e)})}({},function(){return this}());
//# sourceMappingURL=animatePaper.min.js.map